Привет!
Так у тебя ничего не поменялось - ты так же внутри цикла рассчитываешь хэши для каждой подстроки за O(n).
Почитай ещё раздел нашей теории про вычисление скользящего хеша, и ссылки которые я скидывал выше.
По условию задачи нам разрешено делать предподсчёты хеша префиксов исходной строки.
То есть для строки 'abcd' можно заранее посчитать хеши 'a', 'ab', 'abc', 'abcd'.
А уже потом можно вычислять хеш, например, подстроки 'bc' через готовые хеши 'a' и 'abc' одной математической операцией за константу.